preprocess:
  cmd: python -m weasel run preprocess
  script:
    - python scripts/convert_corpus.py
  deps:
    - path: assets/train.tsv
      md5: 2782695bc6b8d4ba205874302d3a87aa
    - path: assets/dev.tsv
      md5: cdae904d93224cd6ae865cf4ab152b2f
    - path: assets/test.tsv
      md5: 829eadd24cf32f0c27d912e28b5d0946
    - path: assets/categories.txt
      md5: 88333c30ebbbefc5406a06e923d2266c
  outs:
    - path: corpus/train.spacy
      md5: f635bbca27b3e74844978d1495ff8ab4
    - path: corpus/dev.spacy
      md5: 8aa5c2dd23beb7e8d1d372b455cb6210
    - path: corpus/test.spacy
      md5: ad04e401ea2a304aa84061a131407259
train:
  cmd: python -m weasel run train
  script:
    - python -m spacy train ./configs/cnn.cfg -o training/cnn --gpu-id -1
  deps:
    - path: corpus/train.spacy
      md5: 460111d0076cd86c07a45cc1756d2939
    - path: corpus/dev.spacy
      md5: 0111ce1374c679e75ef4a24d03963679
    - path: configs/cnn.cfg
      md5: 9096071d826ffea02be70fdc5656f65a
  outs:
    - path: training/cnn/model-best
      md5: 75237b56ad8962ade1b2df76cb8efeb7
evaluate:
  cmd: python -m weasel run evaluate
  script:
    - python -m spacy evaluate ./training/cnn/model-best ./corpus/test.spacy --output
      ./metrics/cnn.json
  deps:
    - path: training/cnn/model-best
      md5: 75237b56ad8962ade1b2df76cb8efeb7
    - path: corpus/test.spacy
      md5: f41c6811c0b7e271dc58e69b9237235a
  outs:
    - path: metrics/cnn.json
      md5: 5f4b0242ea3a3dd20af35aa663cb34e9
