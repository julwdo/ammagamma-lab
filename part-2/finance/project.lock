preprocess:
  cmd: python -m weasel run preprocess
  script:
    - python scripts/convert_corpus.py
  deps:
    - path: assets/train.tsv
      md5: cfc2d2862267cba6dba18c562ebd0721
    - path: assets/dev.tsv
      md5: 049cdb3e53e1e47e5c75ff493b849b20
    - path: assets/test.tsv
      md5: 737b25761c2e0d4dfd92242cb5d8b94c
    - path: assets/categories.txt
      md5: 88333c30ebbbefc5406a06e923d2266c
  outs:
    - path: corpus/train.spacy
      md5: ebc0f9eec799b02c2b6ec7d77f9d8eaf
    - path: corpus/dev.spacy
      md5: 7c79182c1c412984a25e50df11bf97e1
    - path: corpus/test.spacy
      md5: fbfd23a195ff6ac00b735b4f7418a4bf
train:
  cmd: python -m weasel run train
  script:
    - python -m spacy train ./configs/cnn.cfg -o training/cnn --gpu-id -1
  deps:
    - path: corpus/train.spacy
      md5: ebc0f9eec799b02c2b6ec7d77f9d8eaf
    - path: corpus/dev.spacy
      md5: 7c79182c1c412984a25e50df11bf97e1
    - path: configs/cnn.cfg
      md5: 9096071d826ffea02be70fdc5656f65a
  outs:
    - path: training/cnn/model-best
      md5: 0da9ec662c7b8b3af79455a315940956
evaluate:
  cmd: python -m weasel run evaluate
  script:
    - python -m spacy evaluate ./training/cnn/model-best ./corpus/test.spacy --output
      ./metrics/cnn.json
  deps:
    - path: training/cnn/model-best
      md5: 0da9ec662c7b8b3af79455a315940956
    - path: corpus/test.spacy
      md5: fbfd23a195ff6ac00b735b4f7418a4bf
  outs:
    - path: metrics/cnn.json
      md5: 7e7bfb083c3e40df3a00d6530eac3190
